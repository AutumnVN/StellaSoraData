local AchievementChecker = {}
local MonsterRelevant = require("Game.Adventure.AchievementCheck.MonsterRelevant")
local SkillsRelevant = require("Game.Adventure.AchievementCheck.SkillsRelevant")
local PlayerRelevant = require("Game.Adventure.AchievementCheck.PlayerRelevant")
AchievementChecker.BattleAchievementCheckFunction = {
	[GameEnum.questCompleteCondClient.KillMonsterWithoutHitBySkill] = SkillsRelevant.KillMonsterWithoutHitBySkill,
	[GameEnum.questCompleteCondClient.KillMonsterWithoutKillSpecifiedMonster] = MonsterRelevant.CheckKillMonsterWithoutKillSpecifiedMonster,
	[GameEnum.questCompleteCondClient.KillMonsterWithOneAttack] = MonsterRelevant.CheckKillMonsterWithOneAttack,
	[GameEnum.questCompleteCondClient.CritCount] = PlayerRelevant.CritCount,
	[GameEnum.questCompleteCondClient.CastSkillTypeCount] = PlayerRelevant.CastSkillTypeCount,
	[GameEnum.questCompleteCondClient.CastSkillCount] = PlayerRelevant.CastSkillCount,
	[GameEnum.questCompleteCondClient.ExtremDodgeCount] = PlayerRelevant.ExtremDodgeCount,
	[GameEnum.questCompleteCondClient.KillMonsterClass] = MonsterRelevant.KillMonsterClass,
	[GameEnum.questCompleteCondClient.TriggerTagElement] = PlayerRelevant.TriggerTagElement,
	[GameEnum.questCompleteCondClient.OneHitDamage] = PlayerRelevant.OneHitDamage,
	[GameEnum.questCompleteCondClient.ClearLevelWithHPBelow] = PlayerRelevant.ClearLevelWithHPBelow,
	[GameEnum.questCompleteCondClient.KillMonsterWithTag] = MonsterRelevant.KillMonsterWithTag,
	[GameEnum.questCompleteCondClient.KillMonsterWithSkin] = MonsterRelevant.KillMonsterWithSkin
}
function AchievementChecker:CheckBattleAchievement(tbAchievementId, tbRet, bBattleSuccess)
	local battleData = NovaAPI.GetAchievementData()
	if battleData == nil then
		printError("\230\136\144\229\176\177\230\136\152\230\150\151\230\149\176\230\141\174null")
		return
	end
	for _, nAchievementId in ipairs(tbAchievementId) do
		local mapAchievementData = ConfigTable.GetData("Achievement", nAchievementId)
		if mapAchievementData == nil then
			printError("\230\136\144\229\176\177\230\149\176\230\141\174\228\184\141\229\173\152\229\156\168\239\188\154" .. nAchievementId)
			return
		end
		if mapAchievementData.CompleteCondClient > 999 then
			local bHasValue, nCount = battleData.specialBattleData:TryGetValue(mapAchievementData.CompleteCondClient)
			print("Check Special Battle Achievement:" .. nAchievementId .. " Type:" .. mapAchievementData.CompleteCondClient)
			if bHasValue and 0 < nCount then
				print("Add Special Battle Achievement:" .. nAchievementId .. " Type:" .. mapAchievementData.CompleteCondClient .. " Count:" .. nCount)
				table.insert(tbRet, {
					Data = {nCount, nAchievementId},
					Id = GameEnum.eventTypes.eClient
				})
			end
		else
			if self.BattleAchievementCheckFunction[mapAchievementData.CompleteCondClient] == nil then
				printError("\230\136\144\229\176\177\230\163\128\230\181\139\230\150\185\230\179\149\230\156\170\231\187\145\229\174\154\239\188\154" .. mapAchievementData.CompleteCondClient)
				return
			end
			local nCount = self.BattleAchievementCheckFunction[mapAchievementData.CompleteCondClient](mapAchievementData, battleData, bBattleSuccess)
			if 0 < nCount then
				print(string.format("\230\136\144\229\176\177%d\229\174\140\230\136\144", nAchievementId))
				table.insert(tbRet, {
					Data = {nCount, nAchievementId},
					Id = GameEnum.eventTypes.eClient
				})
			end
		end
	end
end
return AchievementChecker
